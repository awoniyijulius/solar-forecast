services:
  # ---------------------------------------------------
  # üåû BACKEND API (FastAPI) [FREE TIER]
  # ---------------------------------------------------
  - type: web
    name: solarsight-api
    env: python
    region: oregon
    plan: free
    buildCommand: pip install -r backend/requirements.txt
    startCommand: cd backend && uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.3
      - key: MODEL_PATH
        value: /opt/render/project/src/ml/artifacts/lightgbm_model.joblib

  # ---------------------------------------------------
  # üé® FRONTEND (React + Vite) [FREE TIER]
  # ---------------------------------------------------
  - type: web
    name: solarsight-frontend
    env: static
    buildCommand: cd frontend && npm install && npm run build
    staticPublishPath: frontend/dist
    # envVars:
    #   - key: VITE_API_URL
    #     fromService:
    #       type: web
    #       name: solarsight-api
    #       property: host

  # ---------------------------------------------------
  # üõ°Ô∏è ADMIN DASHBOARD (Streamlit) [FREE TIER]
  # ---------------------------------------------------
  - type: web
    name: solarsight-admin
    env: python
    region: oregon
    plan: free
    buildCommand: pip install -r streamlit/requirements.txt
    startCommand: streamlit run streamlit/app.py --server.port $PORT --server.address 0.0.0.0
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.3
      # - key: BACKEND_URL
      #   fromService:
      #     type: web
      #     name: solarsight-api
      #     property: host
